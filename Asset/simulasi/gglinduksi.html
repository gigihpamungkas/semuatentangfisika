    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        .simulation-wrapper {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            font-family: 'Segoe UI', sans-serif;
            background-color: #f4f7f6;
            padding: 10px;
            box-sizing: border-box;
        }

        #ui-panel {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 10px;
        }

        .slider-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .slider-label {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        #canvas-holder {
            width: 100%;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            overflow: hidden;
            touch-action: none; /* Penting untuk interaksi di HP */
        }

        button {
            margin-top: 15px;
            width: 100%;
            padding: 10px;
            cursor: pointer;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: bold;
        }
    </style>

<div class="simulation-wrapper">
    <div id="ui-panel">
        <h2 style="font-size: 1.2rem; color: #2c3e50; margin-top: 0;">Eksperimen Hukum Faraday Pro</h2>
        
        <div class="slider-container">
            <div>
                <div class="slider-label">Lilitan (N): <span id="n-value" style="color: #e67e22;">20</span></div>
                <div id="n-slider-holder"></div>
            </div>
            <div>
                <div class="slider-label">Medan (B): <span id="b-value" style="color: #3498db;">1.5</span> T</div>
                <div id="b-slider-holder"></div>
            </div>
        </div>

        <button id="reset-btn">RESET EKSPERIMEN</button>
    </div>
    
    <div id="canvas-holder"></div>
</div>

<script>
let magnetX, prevMagnetX, current = 0;
let nSlider, bSlider;
let canvas;

function setup() {
    let container = document.getElementById('canvas-holder');
    canvas = createCanvas(container.offsetWidth, 400);
    canvas.parent('canvas-holder');
    
    magnetX = width * 0.2;
    prevMagnetX = magnetX;

    nSlider = createSlider(1, 100, 20, 1);
    nSlider.parent('n-slider-holder');
    nSlider.style('width', '100%');

    bSlider = createSlider(0.1, 5.0, 1.5, 0.1);
    bSlider.parent('b-slider-holder');
    bSlider.style('width', '100%');

    document.getElementById('reset-btn').addEventListener('click', () => {
        nSlider.value(20);
        bSlider.value(1.5);
        magnetX = width * 0.2;
        prevMagnetX = magnetX;
    });
}

function windowResized() {
    let container = document.getElementById('canvas-holder');
    resizeCanvas(container.offsetWidth, 400);
}

function draw() {
    background(255);
    
    document.getElementById('n-value').innerText = nSlider.value();
    document.getElementById('b-value').innerText = bSlider.value().toFixed(1);

    // LOGIKA FISIKA (Gunakan width sebagai referensi)
    if (mouseX > 0 && mouseX < width && mouseY > 0 && mouseY < height) {
        magnetX = lerp(prevMagnetX, mouseX, 0.2);
    }
    magnetX = constrain(magnetX, 50, width - 50);
    
    let velocity = magnetX - prevMagnetX;
    let nTurns = nSlider.value();
    let bField = bSlider.value();
    
    let centerX = width / 2;
    let distanceToCoil = abs(magnetX - centerX);
    
    if (distanceToCoil < width * 0.25) {
        // Skala induksi GGL: ε = -N * dΦ/dt
        current = velocity * nTurns * bField * exp(-distanceToCoil * 0.04) * 0.08;
    } else {
        current = lerp(current, 0, 0.1);
    }

    // VISUALISASI RESPONSIF
    drawMagneticField(magnetX - 20, height/2, bField);
    drawCoil(centerX, height/2, nTurns, current);
    drawMagnet(magnetX, height/2);
    
    // Amperemeter diletakkan secara relatif di kanan atas
    drawAmperemeter(width - 100, 100, current);
    
    prevMagnetX = magnetX;
}

function drawMagnet(x, y) {
    rectMode(CENTER);
    noStroke();
    fill(0, 50, 200); rect(x - 20, y, 40, 50, 5); // South
    fill(220, 20, 60); rect(x + 20, y, 40, 50, 5);  // North
    fill(255); textSize(14); textAlign(CENTER, CENTER);
    text("S", x - 20, y); text("N", x + 20, y);
}

function drawCoil(x, y, n, cur) {
    stroke(184, 115, 51);
    strokeWeight(2 + n/50);
    noFill();
    let visualTurns = min(n, 12); 
    for (let i = 0; i < visualTurns; i++) {
        let xOff = i * 8 - (visualTurns * 4);
        ellipse(x + xOff, y, 40, 120);
        if (abs(cur) > 0.5) {
            drawArrow(x + xOff, y - 65, cur > 0 ? "UP" : "DOWN");
        }
    }
}

function drawArrow(x, y, dir) {
    push();
    stroke(46, 204, 113); fill(46, 204, 113);
    translate(x, y);
    if (dir === "DOWN") rotate(PI);
    line(0, -8, 0, 8);
    triangle(-4, -4, 4, -4, 0, -12);
    pop();
}

function drawMagneticField(x, y, strength) {
    noFill();
    let alpha = map(strength, 0.1, 5.0, 10, 100);
    stroke(0, 100, 255, alpha);
    strokeWeight(strength); 
    for (let i = 1; i <= 3; i++) {
        ellipse(x, y, 60 * i, 25 * i);
    }
}

function drawAmperemeter(x, y, val) {
    push();
    translate(x, y);
    // Skala Amperemeter otomatis mengecil jika layar sempit
    let s = width < 500 ? 0.7 : 1.0; 
    scale(s);
    
    fill(245); stroke(50); strokeWeight(2);
    rect(0, 0, 150, 130, 10);
    fill(20, 40, 20); rect(0, 45, 90, 25, 5);
    fill(100, 255, 100); noStroke();
    textAlign(CENTER, CENTER); textSize(14);
    text(val.toFixed(2) + " mA", 0, 45);
    
    noFill(); stroke(100); arc(0, 10, 100, 100, PI, TWO_PI);
    let angle = map(constrain(val, -100, 100), -100, 100, -HALF_PI, HALF_PI);
    push();
    translate(0, 10); rotate(angle);
    stroke(255, 0, 0); strokeWeight(2);
    line(0, 0, 0, -45);
    pop();
    fill(50); textSize(10); text("AMPEREMETER", 0, -50);
    pop();
}
</script>
